<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>Important Part of Gradient Descent Convergence Proof</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/styles.css">

  

  

  

  <script src="/assets/js/utils.js"></script>

  
  <link rel="stylesheet" href="/assets/css/blog.css">
  <script src="https://distill.pub/template.v2.js"></script>
  <script defer type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  

  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="jekyll" />
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Important Part of Gradient Descent Convergence Proof | jekyll</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Important Part of Gradient Descent Convergence Proof" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="By Bolun Dai Feb 10th 2021" />
<meta property="og:description" content="By Bolun Dai Feb 10th 2021" />
<link rel="canonical" href="http://localhost:4000/2021/02/10/part_of_grad_desc_proof.html" />
<meta property="og:url" content="http://localhost:4000/2021/02/10/part_of_grad_desc_proof.html" />
<meta property="og:site_name" content="jekyll" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-10T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Important Part of Gradient Descent Convergence Proof" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-02-10T00:00:00-05:00","datePublished":"2021-02-10T00:00:00-05:00","description":"By Bolun Dai Feb 10th 2021","headline":"Important Part of Gradient Descent Convergence Proof","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2021/02/10/part_of_grad_desc_proof.html"},"url":"http://localhost:4000/2021/02/10/part_of_grad_desc_proof.html"}</script>
<!-- End Jekyll SEO tag -->

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3NQ4FBB1FB"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-3NQ4FBB1FB');
</script>
</head>



<body class="mx-auto" style="width: 96%;">
  <div id="page-container">
    <div id="content-wrap">
      <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid mx-2">
        <a href="/" class="navbar-brand header-brand">Bolun Dai</a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navmenu">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse me-5" id="navmenu">
            <ul class="navbar-nav ms-auto">
                
                <li class="nav-item nav-item-bolun">
                    
                    <a href="/blog.html" class="nav-link" onmouseover="addUnderline(this)"
                        onmouseleave="removeUnderline(this)">
                        Blog
                    </a>
                    
                </li>
                
                <li class="nav-item nav-item-bolun">
                    
                    <a href="/cv.html" class="nav-link" onmouseover="addUnderline(this)"
                        onmouseleave="removeUnderline(this)">
                        CV
                    </a>
                    
                </li>
                
                <li class="nav-item nav-item-bolun">
                    
                    <a href="/research.html" class="nav-link" onmouseover="addUnderline(this)"
                        onmouseleave="removeUnderline(this)">
                        Research
                    </a>
                    
                </li>
                
            </ul>
        </div>
    </div>
</nav>
      <div class="post distill">
    <d-title class="blog-title">
        <h1>Important Part of Gradient Descent Convergence Proof</h1>
        <p class="blog-date">By Bolun Dai | Feb 10th 2021</p>
    </d-title>

    <d-article class="blog-content">
        

        <p>This blog post proves a crucial statement in the gradient descent convergence analysis: from the assumption \(f\) is convex, twice differentiable function and \(\nabla{f}\) is Lipschitz continuous with constant \(L&gt;0\) we have</p>

\[f(y) \leq f(x) + \nabla{f}(x)^T(y - x) + \frac{L}{2}\|y-x\|_2^2.\]

<p>Here we list four statements:</p>
<ul>
  <li>(1) \(\nabla{f}\) is Lipschitz continuous with constant \(L&gt;0\)</li>
  <li>(2) \((\nabla{f}(x)-\nabla{f}(y))^T(x-y)\leq L\|x-y\|_2^2\)</li>
  <li>(3) \(\nabla^2{f}(x)\preceq LI\)</li>
  <li>(4) \(f(y) \leq f(x) + \nabla{f}(x)^T(y - x) + \frac{L}{2}\|y-x\|_2^2\)</li>
</ul>

<p>The outline of the proof is \(\mathrm{i}\rightarrow \mathrm{iii} \rightarrow \mathrm{iv}\) but the proof of \(\mathrm{i}\rightarrow \mathrm{ii}\) is also given.</p>

<h2 id="i--ii">i → ii</h2>

<p>From \(\nabla{f}\) is Lipschitz continuous with constant \(L&gt;0\) we know \(\|\nabla{f}(x) - \nabla{f}(y)\|_2\leq L\|x-y\|_2\). From the Cauchy-Schwartz inequality we have</p>

\[|\langle u, v\rangle| \leq \|u\|_2\|v\|_2.\]

<p>Setting \(u = \nabla{f}(x) - \nabla{f}(y)\) and \(v = x - y\) we have</p>

\[\begin{align*}
|(\nabla{f}(x) - \nabla{f}(y))^T(x - y)| &amp;\leq \|\nabla{f}(x) - \nabla{f}(y)\|_2\|x - y\|_2\\
&amp;\leq L\|x-y\|_2\|x - y\|_2 &amp; \mathrm{Lipschitz\ condition}\\
&amp;\leq L\|x-y\|_2^2.
\end{align*}\]

<p>Since we have the absolute value of \((\nabla{f}(x) - \nabla{f}(y))^T(x - y)\) less than or equal to
\(L\|x-y\|_2^2\), we definetely have</p>

\[(\nabla{f}(x)-\nabla{f}(x))^T(x-y)\leq L\|x-y\|_2^2.\]

<h2 id="i--iii">i → iii</h2>

<p>From the mean value theorem we can have</p>

<p>\(\frac{\nabla f(x + \Delta{x}) - \nabla f(x)}{\Delta{x}} = \nabla^2f(x + t\Delta{x}),\ t\in[0, 1].\)
If we multiply both sides with \(\Delta{x}\) and take the norm on both sides gives us</p>

\[\begin{align*}
\|\nabla^2f(x + t\Delta{x})\Delta{x}\| &amp;= \|\nabla f(x + \Delta{x}) - \nabla f(x)\|\\
\|\nabla^2f(x + t\Delta{x})\|\|\Delta{x}\| &amp;\leq L\|\Delta{x}\|\\
\|\nabla^2f(x + t\Delta{x})\| &amp;\leq L\\
\|\nabla^2f(x)\| &amp;\leq L &amp; \mathrm{set}\ t\rightarrow 0\
\end{align*}\]

<p>Since \(f\) is a convex function, we know its Hessian is positive semidefinite. Thus,
\(\|\nabla^2f(x)\|\) represents the spectral norm, which is equal to its largest eigenvalue. Thus we
have \(\nabla^2{f}(x)\preceq LI\). See definition 7 and fact 8 of <a href="/assets/images/convex_opt/NotesMatrices.pdf">this note</a>.</p>

<h3 id="iii--iv">iii → iv</h3>

<p>From the second-order Taylor series we have</p>

\[f(y) = f(x) + \nabla f(x)^T(y - x) + \frac{1}{2}(y - x)^T\nabla^2{f}(x)(y - x).\]

<p>From \(\nabla^2{f}(x)\preceq LI\) we have</p>

\[\frac{1}{2}(y - x)^T\nabla^2{f}(x)(y - x) \leq \frac{1}{2}(y - x)^TLI(y - x) = \frac{L}{2}\|y-x\|_2^2.\]

<p>Thus we have</p>

\[f(y) \leq f(x) + \nabla{f}(x)^T(y - x) + \frac{L}{2}\|y-x\|_2^2.\]

<h2 id="i--iv">i → iv</h2>

<p>Prof.Joan Bruna’s mentioned in his class a way to prove iv from i which I did not think of before, thus I will include it here. If we have \(F(t) = f\big(y + t(x-y)\big)\), then using the fundamental theorem of calculus</p>

\[F(b) - F(a) = \int_{b}^{a}{f(t)dt},\ \mathrm{if\ }F^\prime(t) = f(t),\]

<p>we can have</p>

\[\begin{align}
F(b) - F(a) &amp;= \int_{b}^{a}{F^\prime(t)dt}\\
&amp;= \int_{b}^{a}{(x-y)\nabla{f}\big(y + t(x-y)\big)dt}.
\end{align}\]

<p>By setting \(a = 1\) and \(b = 0\) we have</p>

\[F(b) - F(a) = f(x) - f(y) = \int_{0}^{1}{(x-y)\nabla{f}\big(y + t(x-y)\big)dt},\]

<p>which can be written as</p>

\[f(x) - f(y) = \int_{0}^{1}{\Big\langle\nabla{f}\big(y + t(x-y)\big), (x-y)\Big\rangle dt}.\]

<p>Also we need to note that for a constant \(s\) or function \(s(x)\) with no \(t\) in the input, we have \(F(x) = s(x)t\) and \(dF(x)/dt = s(x)\). Thus, using the fundamental theorem of calculus we have</p>

\[s(x) = \int_{0}^{1}s(x)dt = s(x)t\Big|_0^1 = s(x) - 0.\]

<p>Therefore, we have</p>

\[\begin{align}
\Bigg|f(x) - f(y) - \langle\nabla f(y), x-y\rangle\Bigg| &amp;=
\Bigg|\int_{0}^{1}{\Big\langle\nabla{f}\big(y +
t(x-y)\big), x-y\Big\rangle dt} - \int_{0}^{1}{\langle\nabla f(y), x-y\rangle dt}\Bigg|\\
&amp;= \Bigg|\int_{0}^{1}{\Big\langle\Big[\nabla{f}\big(y + t(x-y)\big) - \nabla f(y)\Big],
x-y\Big\rangle dt}\Bigg|\\
&amp;\leq \int_{0}^{1}{\Bigg|\Big\langle\Big[\nabla{f}\big(y + t(x-y)\big) - \nabla f(y)\Big],
x-y\Big\rangle\Bigg|dt}\\
&amp;\leq \int_{0}^{1}{\Big\|\nabla{f}\big(y + t(x-y)\big) - \nabla f(y)\Big\|\Big\|x-y\Big\|dt}\\
&amp;\leq \int_{0}^{1}{L\Big\|t(x-y)\Big\|\Big\|x-y\Big\|dt}\\
&amp;= L\|x-y\|^2\int_{0}^{1}{tdt}\\
&amp;= \frac{L}{2}\|x-y\|^2.
\end{align}\]

<p>Then we finally have</p>

\[f(x) \leq f(y) + \langle\nabla f(y), x-y\rangle + \frac{L}{2}\|x-y\|^2,\ \forall x, y.\]

<d-byline></d-byline>

<p class="citation">
    Credit to Ryan Tibshirani, powered by <a href="https://www.mathjax.org">
    <img title="Powered by MathJax" src="https://www.mathjax.org/badge/mj_logo.png" style="border:0;" alt="Powered by MathJax" />
    </a>
</p>

    </d-article>

    <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
    </d-appendix>

</div>
    </div>
    <footer id="footer">
    <div class="container-fluid">
        <div class="row mx-5">
            <p class="footer-p col-6">&copy Bolun Dai 2022</p>
            <p class="col-6 text-end">
                <a href="mailto:bd1555@nyu.edu" style="padding: 0px 0px 0px 2%; text-decoration: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="white"
                        class="bi bi-envelope-fill" viewBox="0 0 16 16">
                        <path
                            d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555zM0 4.697v7.104l5.803-3.558L0 4.697zM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757zm3.436-.586L16 11.801V4.697l-5.803 3.546z" />
                    </svg>
                </a>

                <a href="https://www.linkedin.com/in/bolun-dai" style="padding: 0px 0px 0px 2%; text-decoration: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="white" class="bi bi-linkedin"
                        viewBox="0 0 16 16">
                        <path
                            d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z" />
                    </svg>
                </a>

                <a href="https://github.com/BolunDai0216" style="padding: 0px 0px 0px 2%; text-decoration: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="white" class="bi bi-github"
                        viewBox="0 0 16 16">
                        <path
                            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" />
                    </svg>
                </a>

                <a href="https://scholar.google.com/citations?user=AkuPvYUAAAAJ&hl=en&oi=ao"
                    style="padding: 0px 0px 0px 2%; text-decoration: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" class="bi bi-google"
                        viewBox="0 0 16 16">
                        <path
                            d="M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z" />
                    </svg>
                </a>
            </p>
        </div>
    </div>
</footer>
  </div>
</body>


<d-bibliography src="/assets/bibliography/">
</d-bibliography>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

</html>